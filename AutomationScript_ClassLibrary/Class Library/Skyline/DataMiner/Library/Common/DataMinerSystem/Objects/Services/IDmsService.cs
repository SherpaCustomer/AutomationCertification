namespace Skyline.DataMiner.Library.Common
{
	using System;
	using System.Collections.Generic;
	using Properties;

	/// <summary>
	/// DataMiner service interface.
	/// </summary>
	public interface IDmsService : IDmsObject, IUpdateable
	{
		/// <summary>
		/// Gets the advanced settings of this service.
		/// </summary>
		/// <value>The advanced settings of this service.</value>
		IAdvancedServiceSettings AdvancedSettings { get; }

		/// <summary>
		/// Gets the parameter settings of this service.
		/// </summary>
		/// <value>The parameter settings of this service.</value>
		IServiceParamsSettings ParameterSettings { get; }

		/// <summary>
		/// Gets the replication settings.
		/// </summary>
		/// <value>The replication settings.</value>
		IReplicationServiceSettings ReplicationSettings { get; }

		/// <summary>
		/// Gets the DataMiner Agent ID.
		/// </summary>
		/// <value>The DataMiner Agent ID.</value>
		int AgentId { get; }

		/// <summary>
		/// Gets or sets the service description.
		/// </summary>
		/// <value>The service description.</value>
		string Description { get; set; }

		/// <summary>
		/// Gets the system-wide service ID of the service.
		/// </summary>
		/// <value>The system-wide service ID of the service.</value>
		DmsServiceId DmsServiceId { get; }

		/// <summary>
		/// Gets the DataMiner Agent that hosts this service.
		/// </summary>
		/// <value>The DataMiner Agent that hosts this service.</value>
		IDma Host { get; }

		/// <summary>
		/// Gets the service ID.
		/// </summary>
		/// <value>The service ID.</value>
		int Id { get; }

		/// <summary>
		/// Gets or sets the service name.
		/// </summary>
		/// <value>The service name.</value>
		/// <exception cref="ArgumentNullException">The value of a set operation is <see langword="null"/>.</exception>
		/// <exception cref="ArgumentException">The value of a set operation is empty or white space.</exception>
		/// <exception cref="ArgumentException">The value of a set operation exceeds 200 characters.</exception>
		/// <exception cref="ArgumentException">The value of a set operation contains a forbidden character.</exception>
		/// <exception cref="ArgumentException">The value of a set operation contains more than one '%' character.</exception>
		/// <remarks>
		/// <para>The following restrictions apply to service names:</para>
		/// <list type="bullet">
		///		<item><para>Names may not start or end with the following characters: '.' (dot), ' ' (space).</para></item>
		///		<item><para>Names may not contain the following characters: '\', '/', ':', '*', '?', '"', '&lt;', '&gt;', '|', '°', ';'.</para></item>
		///		<item><para>The following characters may not occur more than once within a name: '%' (percentage).</para></item>
		/// </list>
		/// </remarks>
		string Name { get; set; }

		/// <summary>
		/// Gets the properties of this service.
		/// </summary>
		/// <value>The service properties.</value>
		IPropertyCollection<IDmsServiceProperty, IDmsServicePropertyDefinition> Properties { get; }

		/// <summary>
		/// Gets the views the service is part of.
		/// </summary>
		/// <value>The views the service is part of.</value>
		/// <exception cref="ArgumentNullException">The value of a set operation is <see langword = "null" />.</exception>
		/// <exception cref="ArgumentException">The value of a set operation is an empty collection.</exception>
		ISet<IDmsView> Views { get; }

		/// <summary>
		/// Gets the state of the service.
		/// </summary>
		/// <returns>The service state.</returns>
		/// <exception cref="ServiceNotFoundException">The service was not found in the DataMiner System.</exception>
		IServiceState GetState();

		/// <summary>
		/// Deletes the service.
		/// </summary>
		/// <exception cref="ServiceNotFoundException">The service was not found in the DataMiner System.</exception>
		void Delete();

		/// <summary>
		///     Duplicates the service.
		/// </summary>
		/// <param name="newServiceName">The name to assign to the duplicated service.</param>
		/// <param name="agent">The target DataMiner Agent where the duplicated service should be created.</param>
		/// <exception cref="ArgumentNullException"><paramref name="newServiceName" /> is <see langword="null" />.</exception>
		/// <exception cref="ArgumentException"><paramref name="newServiceName" /> is invalid.</exception>
		/// <exception cref="NotSupportedException">The service is a service template or generated by a service template.</exception>
		/// <exception cref="AgentNotFoundException">The specified DataMiner Agent was not found in the DataMiner System.</exception>
		/// <exception cref="ServiceNotFoundException">The service was not found in the DataMiner System.</exception>
		/// <exception cref="IncorrectDataException">Invalid data.</exception>
		/// <returns>The duplicated service.</returns>
		IDmsService Duplicate(string newServiceName, IDma agent = null);
	}
}